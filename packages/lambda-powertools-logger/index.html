
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>logger Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="../lambda-powertools-correlation-ids/" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    overview
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Clients</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../lambda-powertools-cloudwatchevents-client/">
            
                <a href="../lambda-powertools-cloudwatchevents-client/">
            
                    
                    cloudwatchevents-client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../lambda-powertools-dynamodb-client/">
            
                <a href="../lambda-powertools-dynamodb-client/">
            
                    
                    dynamodb-client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../lambda-powertools-eventbridge-client/">
            
                <a href="../lambda-powertools-eventbridge-client/">
            
                    
                    eventbridge-client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../lambda-powertools-firehose-client/">
            
                <a href="../lambda-powertools-firehose-client/">
            
                    
                    firehose-client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../lambda-powertools-http-client/">
            
                <a href="../lambda-powertools-http-client/">
            
                    
                    http-client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="../lambda-powertools-kinesis-client/">
            
                <a href="../lambda-powertools-kinesis-client/">
            
                    
                    kinesis-client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="../lambda-powertools-lambda-client/">
            
                <a href="../lambda-powertools-lambda-client/">
            
                    
                    lambda-client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="../lambda-powertools-sns-client/">
            
                <a href="../lambda-powertools-sns-client/">
            
                    
                    sns-client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="../lambda-powertools-sqs-client/">
            
                <a href="../lambda-powertools-sqs-client/">
            
                    
                    sqs-client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="../lambda-powertools-step-functions-client/">
            
                <a href="../lambda-powertools-step-functions-client/">
            
                    
                    step-functions-client
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Middlewares</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../lambda-powertools-middleware-correlation-ids/">
            
                <a href="../lambda-powertools-middleware-correlation-ids/">
            
                    
                    middleware-correlation-ids
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../lambda-powertools-middleware-log-timeout/">
            
                <a href="../lambda-powertools-middleware-log-timeout/">
            
                    
                    middleware-log-timeout
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../lambda-powertools-middleware-obfuscater/">
            
                <a href="../lambda-powertools-middleware-obfuscater/">
            
                    
                    middleware-obfuscater
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../lambda-powertools-middleware-sample-logging/">
            
                <a href="../lambda-powertools-middleware-sample-logging/">
            
                    
                    middleware-sample-logging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="../lambda-powertools-middleware-stop-infinite-loop/">
            
                <a href="../lambda-powertools-middleware-stop-infinite-loop/">
            
                    
                    middleware-stop-infinite-loop
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Patterns</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../lambda-powertools-pattern-basic/">
            
                <a href="../lambda-powertools-pattern-basic/">
            
                    
                    pattern-basic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../lambda-powertools-pattern-obfuscate/">
            
                <a href="../lambda-powertools-pattern-obfuscate/">
            
                    
                    pattern-obfuscate
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Utils</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../lambda-powertools-correlation-ids/">
            
                <a href="../lambda-powertools-correlation-ids/">
            
                    
                    correlation-ids
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="5.2" data-path="./">
            
                <a href="./">
            
                    
                    logger
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >logger</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="lambda-powertools-logger">lambda-powertools-logger</h1>
<p>Logger that is tightly integrated with the rest of the <code>lambda-powertools</code>, and knows to automatically include any correlation IDs that have been captured with <code>@dazn/lambda-powertools-correlation-ids</code>.</p>
<p>Main features:</p>
<ul>
<li><p>structured logging with JSON</p>
</li>
<li><p>includes a number of common attributes: <code>awsRegion</code>, <code>functionName</code>, <code>functionVersion</code>, <code>functionMemorySize</code> and <code>environment</code></p>
</li>
<li><p>supports sampling of debug logs with the <code>enableDebug</code> function (see below for more details)</p>
</li>
<li><p>allow log level to be changed live via the <code>LOG_LEVEL</code> environment variable (allowed values are <code>DEBUG</code>, <code>INFO</code>, <code>WARN</code> and <code>ERROR</code>)</p>
</li>
<li><p>for <code>WARN</code> and <code>ERROR</code> logs, include <code>errorName</code>, <code>errorMessage</code> and <code>stackTrace</code></p>
</li>
</ul>
<h2 id="getting-started">Getting Started</h2>
<p>Install from NPM: <code>npm install @dazn/lambda-powertools-logger</code></p>
<h2 id="api">API</h2>
<p>This illustrates the API for logging:</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> Log = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;@dazn/lambda-powertools-logger&apos;</span>)

Log.debug(<span class="hljs-string">&apos;this is a debug message&apos;</span>)
Log.debug(<span class="hljs-string">&apos;this is a debug message with attributes&apos;</span>, { userId: <span class="hljs-string">&apos;theburningmonk&apos;</span> })

Log.info(<span class="hljs-string">&apos;this is an info message&apos;</span>)
Log.info(<span class="hljs-string">&apos;this is an info message with attributes&apos;</span>, { userId: <span class="hljs-string">&apos;theburningmonk&apos;</span> })

Log.warn(<span class="hljs-string">&apos;this is a warning message&apos;</span>)
Log.warn(<span class="hljs-string">&apos;this is a warning message with attributes&apos;</span>, { userId: <span class="hljs-string">&apos;theburningmonk&apos;</span> })
Log.warn(<span class="hljs-string">&apos;this is a warning message&apos;</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&apos;oops&apos;</span>))
Log.warn(<span class="hljs-string">&apos;this is a warning message with attributes, and error details&apos;</span>, { userId: <span class="hljs-string">&apos;theburningmonk&apos;</span> }, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&apos;oops&apos;</span>))

Log.error(<span class="hljs-string">&apos;this is an error message&apos;</span>)
Log.error(<span class="hljs-string">&apos;this is an error message with attributes&apos;</span>, { userId: <span class="hljs-string">&apos;theburningmonk&apos;</span> })
Log.error(<span class="hljs-string">&apos;this is an error message&apos;</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&apos;oops&apos;</span>))
Log.error(<span class="hljs-string">&apos;this is an error message with attributes, and error details&apos;</span>, { userId: <span class="hljs-string">&apos;theburningmonk&apos;</span> }, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&apos;oops&apos;</span>))
</code></pre>
<p>We don&apos;t want to leave debug logging ON in production, as there are significant impact on:</p>
<ul>
<li><p>CloudWatch Logs cost : CloudWatch Logs charges $0.50 per GB of data ingested</p>
</li>
<li><p>Logz.io cost : Logz.io also charges based on data ingested as well</p>
</li>
<li><p>Lambda cost : there are also Lambda invocation costs for shipping logs from CloudWatch Logs to Logz.io</p>
</li>
<li><p>Lambda concurrency : more things being logged = more Lambda invocations to ship them to Logz.io, which can potentially use up too much of our regional quota of concurrent Lambda executions (default limit is 1000, can be raised through support ticket)</p>
</li>
<li><p>too much noise in the logs, making it harder to find important information</p>
</li>
</ul>
<p>Instead, we should sample debug logs for, say, 1% of invocations.</p>
<p>When used with other lambda-powertools, e.g. <code>@dazn/lambda-powertools-middleware-sample-logging</code>, debug logging can be enabled during an invocation using <code>enableDebug</code> function.</p>
<p>The <code>@dazn/lambda-powertools-middleware-correlation-ids</code> middleware also supplements this behaviour by allowing you to propagate decisions to enable sample logging as a special correlation IDs. This allows an entire call chain (e.g. API Gateway -&gt; Lambda -&gt; Kinesis -&gt; Lambda -&gt; SNS -&gt; Lambda -&gt; HTTP -&gt; API Gateway -&gt; Lambda) to respect the sampling decisions.</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> Log = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;@dazn/lambda-powertools-logger&apos;</span>)
<span class="hljs-comment">// LOG_LEVEL is set to WARN via serverless.yml</span>

Log.debug(<span class="hljs-string">&apos;this is not logged&apos;</span>)

<span class="hljs-keyword">const</span> undoDebugLog = Log.enableDebug()

Log.debug(<span class="hljs-string">&apos;this is logged&apos;</span>)

undoDebugLog()

Log.debug(<span class="hljs-string">&apos;this is not logged&apos;</span>)
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../lambda-powertools-correlation-ids/" class="navigation navigation-prev navigation-unique" aria-label="Previous page: correlation-ids">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"logger","level":"5.2","depth":1,"previous":{"title":"correlation-ids","level":"5.1","depth":1,"path":"packages/lambda-powertools-correlation-ids/README.MD","ref":"./packages/lambda-powertools-correlation-ids/README.MD","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"fontsettings":{"theme":"night","family":"sans","size":2},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"packages/lambda-powertools-logger/README.MD","mtime":"2020-03-02T12:34:00.041Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-03-02T13:45:21.029Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

